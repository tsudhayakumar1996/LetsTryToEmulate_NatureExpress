var x=e=>{throw TypeError(e)};var I=(e,t,s)=>t.has(e)||x("Cannot "+s);var o=(e,t,s)=>(I(e,t,"read from private field"),s?s.call(e):t.get(e)),b=(e,t,s)=>t.has(e)?x("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),h=(e,t,s,n)=>(I(e,t,"write to private field"),n?n.call(e,s):t.set(e,s),s);var N=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},T=typeof window>"u"||"Deno"in globalThis;function ae(){}function oe(e,t){return typeof e=="function"?e(t):e}function J(e){return typeof e=="number"&&e>=0&&e!==1/0}function ce(e,t){return Math.max(e+(t||0)-Date.now(),0)}function le(e,t){return typeof e=="function"?e(t):e}function fe(e,t){return typeof e=="function"?e(t):e}function he(e,t){const{type:s="all",exact:n,fetchStatus:r,predicate:u,queryKey:y,stale:i}=e;if(y){if(n){if(t.queryHash!==_(y,t.options))return!1}else if(!K(t.queryKey,y))return!1}if(s!=="all"){const c=t.isActive();if(s==="active"&&!c||s==="inactive"&&c)return!1}return!(typeof i=="boolean"&&t.isStale()!==i||r&&r!==t.state.fetchStatus||u&&!u(t))}function ye(e,t){const{exact:s,status:n,predicate:r,mutationKey:u}=e;if(u){if(!t.options.mutationKey)return!1;if(s){if(R(t.options.mutationKey)!==R(u))return!1}else if(!K(t.options.mutationKey,u))return!1}return!(n&&t.state.status!==n||r&&!r(t))}function _(e,t){return((t==null?void 0:t.queryKeyHashFn)||R)(e)}function R(e){return JSON.stringify(e,(t,s)=>k(s)?Object.keys(s).sort().reduce((n,r)=>(n[r]=s[r],n),{}):s)}function K(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(s=>!K(e[s],t[s])):!1}function Q(e,t){if(e===t)return e;const s=A(e)&&A(t);if(s||k(e)&&k(t)){const n=s?e:Object.keys(e),r=n.length,u=s?t:Object.keys(t),y=u.length,i=s?[]:{};let c=0;for(let p=0;p<y;p++){const l=s?p:u[p];(!s&&n.includes(l)||s)&&e[l]===void 0&&t[l]===void 0?(i[l]=void 0,c++):(i[l]=Q(e[l],t[l]),i[l]===e[l]&&e[l]!==void 0&&c++)}return r===y&&c===r?e:i}return t}function de(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function A(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function k(e){if(!D(e))return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!D(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function D(e){return Object.prototype.toString.call(e)==="[object Object]"}function W(e){return new Promise(t=>{setTimeout(t,e)})}function be(e,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,t):s.structuralSharing!==!1?Q(e,t):t}function ve(e,t,s=0){const n=[...e,t];return s&&n.length>s?n.slice(1):n}function me(e,t,s=0){const n=[t,...e];return s&&n.length>s?n.slice(0,-1):n}var X=Symbol();function pe(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===X?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var w,v,S,U,Y=(U=class extends N{constructor(){super();b(this,w);b(this,v);b(this,S);h(this,S,t=>{if(!T&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){o(this,v)||this.setEventListener(o(this,S))}onUnsubscribe(){var t;this.hasListeners()||((t=o(this,v))==null||t.call(this),h(this,v,void 0))}setEventListener(t){var s;h(this,S,t),(s=o(this,v))==null||s.call(this),h(this,v,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){o(this,w)!==t&&(h(this,w,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof o(this,w)=="boolean"?o(this,w):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},w=new WeakMap,v=new WeakMap,S=new WeakMap,U),Z=new Y,E,m,F,z,ee=(z=class extends N{constructor(){super();b(this,E,!0);b(this,m);b(this,F);h(this,F,t=>{if(!T&&window.addEventListener){const s=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",n)}}})}onSubscribe(){o(this,m)||this.setEventListener(o(this,F))}onUnsubscribe(){var t;this.hasListeners()||((t=o(this,m))==null||t.call(this),h(this,m,void 0))}setEventListener(t){var s;h(this,F,t),(s=o(this,m))==null||s.call(this),h(this,m,t(this.setOnline.bind(this)))}setOnline(t){o(this,E)!==t&&(h(this,E,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return o(this,E)}},E=new WeakMap,m=new WeakMap,F=new WeakMap,z),g=new ee;function te(){let e,t;const s=new Promise((r,u)=>{e=r,t=u});s.status="pending",s.catch(()=>{});function n(r){Object.assign(s,r),delete s.resolve,delete s.reject}return s.resolve=r=>{n({status:"fulfilled",value:r}),e(r)},s.reject=r=>{n({status:"rejected",reason:r}),t(r)},s}function se(e){return Math.min(1e3*2**e,3e4)}function ne(e){return(e??"online")==="online"?g.isOnline():!0}var H=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function we(e){return e instanceof H}function je(e){let t=!1,s=0,n=!1,r;const u=te(),y=a=>{var f;n||(L(new H(a)),(f=e.abort)==null||f.call(e))},i=()=>{t=!0},c=()=>{t=!1},p=()=>Z.isFocused()&&(e.networkMode==="always"||g.isOnline())&&e.canRun(),l=()=>ne(e.networkMode)&&e.canRun(),B=a=>{var f;n||(n=!0,(f=e.onSuccess)==null||f.call(e,a),r==null||r(),u.resolve(a))},L=a=>{var f;n||(n=!0,(f=e.onError)==null||f.call(e,a),r==null||r(),u.reject(a))},q=()=>new Promise(a=>{var f;r=d=>{(n||p())&&a(d)},(f=e.onPause)==null||f.call(e)}).then(()=>{var a;r=void 0,n||(a=e.onContinue)==null||a.call(e)}),P=()=>{if(n)return;let a;const f=s===0?e.initialPromise:void 0;try{a=f??e.fn()}catch(d){a=Promise.reject(d)}Promise.resolve(a).then(B).catch(d=>{var C;if(n)return;const O=e.retry??(T?0:3),M=e.retryDelay??se,V=typeof M=="function"?M(s,d):M,$=O===!0||typeof O=="number"&&s<O||typeof O=="function"&&O(s,d);if(t||!$){L(d);return}s++,(C=e.onFail)==null||C.call(e,s,d),W(V).then(()=>p()?void 0:q()).then(()=>{t?L(d):P()})})};return{promise:u,cancel:y,continue:()=>(r==null||r(),u),cancelRetry:i,continueRetry:c,canStart:l,start:()=>(l()?P():q().then(P),u)}}var re=e=>setTimeout(e,0);function ie(){let e=[],t=0,s=i=>{i()},n=i=>{i()},r=re;const u=i=>{t?e.push(i):r(()=>{s(i)})},y=()=>{const i=e;e=[],i.length&&r(()=>{n(()=>{i.forEach(c=>{s(c)})})})};return{batch:i=>{let c;t++;try{c=i()}finally{t--,t||y()}return c},batchCalls:i=>(...c)=>{u(()=>{i(...c)})},schedule:u,setNotifyFunction:i=>{s=i},setBatchNotifyFunction:i=>{n=i},setScheduler:i=>{r=i}}}var Se=ie(),j,G,Ee=(G=class{constructor(){b(this,j)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),J(this.gcTime)&&h(this,j,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(T?1/0:5*60*1e3))}clearGcTimeout(){o(this,j)&&(clearTimeout(o(this,j)),h(this,j,void 0))}},j=new WeakMap,G);function Fe(e,t){return typeof e=="function"?e(...t):!!e}function Oe(){}export{J as A,Ee as R,N as S,ye as a,ae as b,me as c,ve as d,pe as e,Z as f,oe as g,_ as h,R as i,de as j,Oe as k,Fe as l,he as m,Se as n,g as o,K as p,je as q,le as r,X as s,be as t,fe as u,ce as v,we as w,ne as x,te as y,T as z};
