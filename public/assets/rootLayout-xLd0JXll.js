import{n as p,E,a9 as x,L as l,w as U,r as f,N as _,aa as m,j as e,ab as j,ac as I}from"./index-D4cGdlsG.js";import{A as O}from"./utils-wexUoY71.js";import{f as T,u as d,g as A,r as h,a as C,J as N}from"./useMutation-CrtdwtLy.js";import{C as S}from"./CircularProgress-BzRpTLP4.js";const F=({children:r})=>{const g=O(),s=p(),{pathname:n}=E(),t=T(N),o=n==="/",{mutate:u}=d({mutationFn:()=>A({endUrl:C}),onSuccess:a=>{g.setQueryData(["me"],()=>a)},onError:a=>{JSON.parse(a.message).message===x&&(h(),s(l,{replace:!0})),U(a)}}),c=!m.includes(n)&&t,i=m.includes(n)&&t;return f.useEffect(()=>{o||(t||s(l,{replace:!0}),i&&s(_,{replace:!0}),c&&u())},[t,s,u,c,i,o]),e.jsx(e.Fragment,{children:r})},L=()=>e.jsx(j,{children:e.jsx(S,{})}),P=({children:r})=>e.jsx(f.Suspense,{fallback:e.jsx(L,{}),children:r});function V(){return e.jsx(F,{children:e.jsx(P,{children:e.jsx(I,{})})})}export{V as default};
