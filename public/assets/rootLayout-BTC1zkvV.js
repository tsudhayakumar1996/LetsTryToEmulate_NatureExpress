import{j as s,as as g,ab as O,at as U,au as x,av as d,aw as y,ac as I,ad as S,r as E,ax as j,ay as P,az as R,aA as h}from"./index-C7SD2Up6.js";import{u as A}from"./useQuery-COdgGquu.js";import{u as N}from"./QueryClientProvider-BuhiEC0T.js";import{u as C}from"./useMutation-gsmpbwGP.js";import{C as D,g as F,a as M}from"./index-rXaMxEIr.js";import{M as n}from"./query-DlllaqnX.js";import"./utils-D_r6aIjw.js";import"./mutation-BLfasIX8.js";import"./emotion-react.browser.esm-QGPxL-g3.js";const f=()=>s.jsx(g,{children:s.jsx(D,{})}),H=({children:t})=>{const o=N(),r=O(),{pathname:a}=U(),[T]=x(),u=T.get("returnTo"),{data:i}=A({queryKey:[n],queryFn:()=>null,staleTime:1/0}),c=a==="/",{mutate:m,isPending:_}=C({mutationFn:async()=>(await new Promise(e=>setTimeout(e,1e3)),await F({endUrl:M})),onSuccess:e=>{o.setQueryData([n],()=>e)},onError:e=>{(JSON.parse(e.message).message===d||JSON.parse(e.message).message===y)&&(r(`${I}?returnTo=${a}`,{replace:!0}),o.setQueryData([n],()=>null)),S(e)}}),l=P.includes(a)&&!i,p=R.includes(a)&&i;return E.useEffect(()=>{c||(p&&r(u??j,{replace:!0}),l&&m())},[r,m,l,c,p,u]),_?s.jsx(f,{}):s.jsx(s.Fragment,{children:t})},L=({children:t})=>s.jsx(E.Suspense,{fallback:s.jsx(f,{}),children:t});function V(){return s.jsx(H,{children:s.jsx(L,{children:s.jsx(h,{})})})}export{V as default};
